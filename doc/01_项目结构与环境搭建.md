# 第一章：项目结构与环境搭建

## 学习目标

- 理解 SmartVoyage 项目的整体架构
- 掌握 Python 虚拟环境的创建和管理
- 了解项目依赖管理和配置文件的使用

## 1. 项目架构概述

SmartVoyage 采用分层架构设计：

```
┌─────────────────────────────────────────┐
│     表现层 (Streamlit 前端)              │
├─────────────────────────────────────────┤
│     接口层 (FastAPI REST API)           │
├─────────────────────────────────────────┤
│     业务层 (A2A Agent / MCP Server)     │
├─────────────────────────────────────────┤
│     智能层 (LLM 意图识别 / SQL 生成)     │
├─────────────────────────────────────────┤
│     数据层 (MySQL + 天气爬虫)            │
└─────────────────────────────────────────┘
```

## 2. 虚拟环境

### 为什么需要虚拟环境？

虚拟环境可以：
- 隔离不同项目的依赖，避免版本冲突
- 保持系统 Python 环境的干净
- 便于项目迁移和部署

### 创建虚拟环境

```bash
# 使用 Conda 创建
conda create -n lang_env python=3.12

# 激活环境
conda activate lang_env

# 退出环境
conda deactivate
```

## 3. 依赖管理

### requirements.txt

`requirements.txt` 文件列出了项目所需的所有 Python 包：

```
langchain>=0.3.0          # LLM 框架
mysql-connector-python    # MySQL 连接器
streamlit                 # 前端框架
...
```

### 安装依赖

```bash
pip install -r requirements.txt
```

## 4. 配置管理

### 为什么使用 .env 文件？

- **安全性**：敏感信息（API Key、密码）不应硬编码在代码中
- **灵活性**：不同环境（开发/测试/生产）可以使用不同配置
- **便捷性**：修改配置无需改动代码

### pydantic-settings

我们使用 `pydantic-settings` 库来管理配置：

```python
from pydantic_settings import BaseSettings

class Settings(BaseSettings):
    mysql_host: str = "localhost"
    mysql_port: int = 3306
    
    model_config = {
        "env_file": ".env"
    }

settings = Settings()  # 自动从 .env 加载
```

## 5. 模块化设计

每个模块都是一个独立的 Python 包：

```
config/
├── __init__.py    # 包标识，导出公共接口
└── settings.py    # 配置管理实现
```

### `__init__.py` 的作用

1. 将目录标记为 Python 包
2. 控制 `from package import *` 的行为
3. 提供模块的公共接口

```python
# config/__init__.py
from .settings import settings

__all__ = ["settings"]
```

## 知识点总结

| 概念 | 说明 |
|------|------|
| 虚拟环境 | 隔离 Python 依赖的独立环境 |
| requirements.txt | Python 依赖清单 |
| .env 文件 | 环境变量配置文件 |
| pydantic-settings | 类型安全的配置管理库 |
| `__init__.py` | Python 包的初始化文件 |

## 下一步

完成环境搭建后，请继续学习 [第二章：数据库设计与连接](02_数据库设计与连接.md)
